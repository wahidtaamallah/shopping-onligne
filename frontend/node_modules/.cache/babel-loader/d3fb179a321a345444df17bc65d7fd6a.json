{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\21620\\\\Desktop\\\\Sports t-shirts\\\\frontend\\\\src\\\\components\\\\pages\\\\order-detail\\\\OrderDetail.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { getOrderDetails } from 'store/order/actions';\nimport { payOrder, payReset } from 'store/paypal/actions';\nimport { PayPalButton } from 'react-paypal-button-v2';\nimport { Spinner, Error } from 'components/shared';\nimport OrderDetailList from './OrderDetailList';\nimport OrderDetailShipping from './OrderDetailShipping';\nimport OrderDetailPayment from './OrderDetailPayment';\nimport OrderDetailSummary from './OrderDetailSummary';\n\nconst OrderDetail = ({\n  match,\n  history,\n  user,\n  getOrderDetails,\n  orderDetails,\n  error,\n  loading,\n  payOrder,\n  paySuccess,\n  payLoading\n}) => {\n  const [sdkReady, setSdkReady] = useState(false);\n  const orderId = match.params.id;\n  useEffect(() => {\n    if (!user) {\n      history.push('/signin');\n    }\n\n    const addPayPalScript = async () => {\n      const {\n        data: clientId\n      } = await axios.get('/api/config/paypal');\n      const script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n\n      script.onload = () => setSdkReady(true);\n\n      document.body.appendChild(script);\n    };\n\n    if (!orderDetails || paySuccess || orderDetails._id !== orderId) {\n      payReset();\n      getOrderDetails(orderId);\n    } else if (!orderDetails.isPaid) {\n      if (!window.paypal) addPayPalScript();else setSdkReady(true);\n    } // eslint-disable-next-line\n\n  }, [orderDetails]);\n\n  const successPaymentHandler = paymentResult => {\n    console.log(paymentResult);\n    payOrder(orderId, paymentResult);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, loading ? /*#__PURE__*/React.createElement(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }) : error ? /*#__PURE__*/React.createElement(Error, {\n    error: error,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"orderDetail\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"orderDetail__left\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"orderDetail_nav\",\n    onClick: () => history.push('/profile'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }, \"\\u2190 Back to Profile\"), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }\n  }, \"CONFIRM ID \", orderDetails._id), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"orderDetail__left-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(OrderDetailShipping, {\n    orderDetails: orderDetails,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(OrderDetailPayment, {\n    orderDetails: orderDetails,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 15\n    }\n  }), orderDetails.orderItems.length === 0 ? /*#__PURE__*/React.createElement(Error, {\n    error: \"Order is empty\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 17\n    }\n  }) : /*#__PURE__*/React.createElement(OrderDetailList, {\n    items: orderDetails === null || orderDetails === void 0 ? void 0 : orderDetails.orderItems,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"orderDetail__right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(OrderDetailSummary, {\n    orderDetails: orderDetails,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }), !orderDetails.isPaid && /*#__PURE__*/React.createElement(React.Fragment, null, payLoading && /*#__PURE__*/React.createElement(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 32\n    }\n  }), !sdkReady ? /*#__PURE__*/React.createElement(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 19\n    }\n  }) : /*#__PURE__*/React.createElement(PayPalButton, {\n    amount: orderDetails.totalPrice,\n    onSuccess: successPaymentHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 19\n    }\n  })))));\n};\n\nconst mapStateToProps = state => ({\n  orderDetails: state.orderApp.orderDetails,\n  loading: state.orderApp.loading,\n  error: state.orderApp.error,\n  paySuccess: state.paypalApp.success,\n  payLoading: state.paypalApp.loading,\n  user: state.userApp.user\n});\n\nconst mapDispatchToProps = {\n  getOrderDetails,\n  payOrder\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(OrderDetail);","map":{"version":3,"sources":["C:/Users/21620/Desktop/Sports t-shirts/frontend/src/components/pages/order-detail/OrderDetail.jsx"],"names":["React","useEffect","useState","axios","connect","getOrderDetails","payOrder","payReset","PayPalButton","Spinner","Error","OrderDetailList","OrderDetailShipping","OrderDetailPayment","OrderDetailSummary","OrderDetail","match","history","user","orderDetails","error","loading","paySuccess","payLoading","sdkReady","setSdkReady","orderId","params","id","push","addPayPalScript","data","clientId","get","script","document","createElement","type","src","async","onload","body","appendChild","_id","isPaid","window","paypal","successPaymentHandler","paymentResult","console","log","orderItems","length","totalPrice","mapStateToProps","state","orderApp","paypalApp","success","userApp","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\n\nimport { getOrderDetails } from 'store/order/actions';\nimport { payOrder, payReset } from 'store/paypal/actions';\n\nimport { PayPalButton } from 'react-paypal-button-v2';\nimport { Spinner, Error } from 'components/shared';\nimport OrderDetailList from './OrderDetailList';\nimport OrderDetailShipping from './OrderDetailShipping';\nimport OrderDetailPayment from './OrderDetailPayment';\nimport OrderDetailSummary from './OrderDetailSummary';\n\nconst OrderDetail = ({\n  match,\n  history,\n  user,\n  getOrderDetails,\n  orderDetails,\n  error,\n  loading,\n  payOrder,\n  paySuccess,\n  payLoading,\n}) => {\n  const [sdkReady, setSdkReady] = useState(false);\n  const orderId = match.params.id;\n\n  useEffect(() => {\n    if (!user) {\n      history.push('/signin');\n    }\n    const addPayPalScript = async () => {\n      const { data: clientId } = await axios.get('/api/config/paypal');\n      const script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}`;\n      script.async = true;\n      script.onload = () => setSdkReady(true);\n      document.body.appendChild(script);\n    };\n    if (!orderDetails || paySuccess || orderDetails._id !== orderId) {\n      payReset();\n      getOrderDetails(orderId);\n    } else if (!orderDetails.isPaid) {\n      if (!window.paypal) addPayPalScript();\n      else setSdkReady(true);\n    }\n    // eslint-disable-next-line\n  }, [orderDetails]);\n\n  const successPaymentHandler = (paymentResult) => {\n    console.log(paymentResult);\n    payOrder(orderId, paymentResult);\n  };\n\n  return (\n    <>\n      {loading ? (\n        <Spinner />\n      ) : error ? (\n        <Error error={error} />\n      ) : (\n        <div className='orderDetail'>\n          <div className='orderDetail__left'>\n            <p\n              className='orderDetail_nav'\n              onClick={() => history.push('/profile')}\n            >\n              &#8592; Back to Profile\n            </p>\n            <h2>CONFIRM ID {orderDetails._id}</h2>\n            <div className='orderDetail__left-container'>\n              <OrderDetailShipping orderDetails={orderDetails} />\n              <OrderDetailPayment orderDetails={orderDetails} />\n              {orderDetails.orderItems.length === 0 ? (\n                <Error error='Order is empty' />\n              ) : (\n                <OrderDetailList items={orderDetails?.orderItems} />\n              )}\n            </div>\n          </div>\n          <div className='orderDetail__right'>\n            <OrderDetailSummary orderDetails={orderDetails} />\n            {!orderDetails.isPaid && (\n              <>\n                {payLoading && <Spinner />}\n                {!sdkReady ? (\n                  <Spinner />\n                ) : (\n                  <PayPalButton\n                    amount={orderDetails.totalPrice}\n                    onSuccess={successPaymentHandler}\n                  />\n                )}\n              </>\n            )}\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nconst mapStateToProps = (state) => ({\n  orderDetails: state.orderApp.orderDetails,\n  loading: state.orderApp.loading,\n  error: state.orderApp.error,\n  paySuccess: state.paypalApp.success,\n  payLoading: state.paypalApp.loading,\n  user: state.userApp.user,\n});\nconst mapDispatchToProps = {\n  getOrderDetails,\n  payOrder,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrderDetail);\n"]},"metadata":{},"sourceType":"module"}